<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Propositional Logics in Coq | Chew’s Everyday Blog</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Propositional Logics in Coq" />
<meta name="author" content="Chew Y. Feng" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Propositional logic calculus, FP programming with Propositions." />
<meta property="og:description" content="Propositional logic calculus, FP programming with Propositions." />
<link rel="canonical" href="/software-foundations/2023/12/03/logics-Coq.html" />
<meta property="og:url" content="/software-foundations/2023/12/03/logics-Coq.html" />
<meta property="og:site_name" content="Chew’s Everyday Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-12-03T00:00:00+11:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Propositional Logics in Coq" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Chew Y. Feng"},"dateModified":"2023-12-03T18:24:28+11:00","datePublished":"2023-12-03T00:00:00+11:00","description":"Propositional logic calculus, FP programming with Propositions.","headline":"Propositional Logics in Coq","mainEntityOfPage":{"@type":"WebPage","@id":"/software-foundations/2023/12/03/logics-Coq.html"},"url":"/software-foundations/2023/12/03/logics-Coq.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Chew&apos;s Everyday Blog" /><script>
    // for MathJax inline
    window.MathJax = {
      tex: {
        inlineMath: [['_', '_'], ['$', '$'], ['\\(', '\\)']]
      }
    };
  </script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/css-doodle/0.37.4/css-doodle.min.js"></script>
  <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Teko">
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chew&#39;s Everyday Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="page-content-background">
        <css-doodle click-to-update>
          <style>
            @grid: 1 / 100vw 100vh / #0a0c27;
            background-size: 200px 200px;
            background-image: @doodle(
              @grid: 6 / 100%;
              @size: 4px;
              font-size: 4px;
              color: hsl(@r240, 30%, 50%);
              box-shadow: @m3x5(
                calc(4em - @nx * 1em) calc(@ny * 1em)
                  @p(@m3(currentColor), @m2(transparent)),
                calc(2em + @nx * 1em) calc(@ny * 1em)
                  @lp
              );
            );
          </style>
        </css-doodle>
      </div>
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Propositional Logics in Coq</h1>
    <p class="post-meta"><span class="tags">
        
      </span><time class="dt-published" datetime="2023-12-03T00:00:00+11:00" itemprop="datePublished">
        Posted At: Dec 3, 2023
      </time><time>
        Modified At: Dec 3, 2023
      </time><span class="dt-tags">
        Category:
        
          <span>Software-Foundations</span>
        
      </span></p>
  </header>


  <div class="post-content e-content" itemprop="articleBody">
    <ul id="markdown-toc">
  <li><a href="#logical-claims---prop-type" id="markdown-toc-logical-claims---prop-type">Logical Claims - <code class="language-plaintext highlighter-rouge">Prop</code> Type</a></li>
  <li><a href="#propositional-logics" id="markdown-toc-propositional-logics">Propositional Logics</a>    <ul>
      <li><a href="#conjunction" id="markdown-toc-conjunction">Conjunction</a></li>
      <li><a href="#disjunction" id="markdown-toc-disjunction">Disjunction</a></li>
      <li><a href="#falsehood-and-negation" id="markdown-toc-falsehood-and-negation">Falsehood and Negation</a></li>
      <li><a href="#truth" id="markdown-toc-truth">Truth</a></li>
      <li><a href="#logical-equivalence" id="markdown-toc-logical-equivalence">Logical Equivalence</a></li>
      <li><a href="#existential-quantification" id="markdown-toc-existential-quantification">Existential Quantification</a></li>
    </ul>
  </li>
  <li><a href="#programming-with-propositions" id="markdown-toc-programming-with-propositions">Programming with Propositions</a>    <ul>
      <li><a href="#parameterized-proposition" id="markdown-toc-parameterized-proposition">Parameterized Proposition</a></li>
      <li><a href="#applying-propositions" id="markdown-toc-applying-propositions">Applying Propositions</a></li>
    </ul>
  </li>
  <li><a href="#booleans-vs-propositions" id="markdown-toc-booleans-vs-propositions">Booleans vs Propositions</a></li>
  <li><a href="#the-logic-of-coq" id="markdown-toc-the-logic-of-coq">The Logic of Coq</a>    <ul>
      <li><a href="#functional-extensionality" id="markdown-toc-functional-extensionality">Functional Extensionality</a></li>
      <li><a href="#exclude-middle" id="markdown-toc-exclude-middle">Exclude Middle</a></li>
    </ul>
  </li>
  <li><a href="#summary" id="markdown-toc-summary">Summary</a></li>
</ul>
<p>This post is a study note from series <a href="https://softwarefoundations.cis.upenn.edu/">software foundation</a>, containing my solutions to the exercises and the summary of the content.</p>
<h2 id="logical-claims---prop-type">Logical Claims - <code class="language-plaintext highlighter-rouge">Prop</code> Type</h2>
<p>Coq is a typed language, in which logical claims also belongs to a type, the type of <em>propositions</em>. Formally, the built-in type <code class="language-plaintext highlighter-rouge">Prop</code> contains all propositions.</p>

<p>Propositions are also first-class entities that can be manipulated in all the same way as any of the other types in Coq.</p>

<p>We can also have <em>parameterized</em> propositions, which take arguments and return a proposition.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Definition</span><span class="w"> </span><span class="no">is_three</span><span class="w"> </span><span class="o">(</span><span class="no">n</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">nat</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w">
  </span><span class="no">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">.</span><span class="w">
</span><span class="k">Check</span><span class="w"> </span><span class="no">is_three</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kr">Prop</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>
<h2 id="propositional-logics">Propositional Logics</h2>
<h3 id="conjunction">Conjunction</h3>
<p>The <em>conjunction</em> or <em>logical and</em> for proposition A and B is written $A \land B$. In Coq, the notation for conjunction is <code class="language-plaintext highlighter-rouge">A /\ B</code>.</p>

<blockquote class="note">
  <p>Not that <code class="language-plaintext highlighter-rouge">/\</code> is not equal to <code class="language-plaintext highlighter-rouge">&amp;&amp;</code>. The former one is the connection of propositions, while the later one is the connection for booleans. Later we’ll see the differences between propositions and booleans.</p>

  <p>Besides, the <code class="language-plaintext highlighter-rouge">/\</code> is just a notation for <code class="language-plaintext highlighter-rouge">and: prop -&gt; prop -&gt; prop</code>.</p>
</blockquote>

<p>To reason propositions in conjunctive form, we need to look at the left and right part of the proposition and make sure both are provable. In Coq, the built-in <code class="language-plaintext highlighter-rouge">split</code> tactic takes this responsibility.</p>

<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** exercise `and_exercise` *)</span><span class="w">
</span><span class="k">Example</span><span class="w"> </span><span class="no">and_exercise</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="kr">forall</span><span class="w"> </span><span class="no">n</span><span class="w"> </span><span class="no">m</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">nat</span><span class="o">,</span><span class="w"> </span><span class="no">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="no">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="pi">.</span><span class="w">
  </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">n</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="no">discriminate</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">m</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">add_comm</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="no">discriminate</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
  </span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>Conversely, if there is a conjunction $A \land B$ in the hypothesis, a simple <code class="language-plaintext highlighter-rouge">desctruct</code> achieves separate A and B.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(* exercise `and_assoc` *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">and_assoc</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="no">R</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">,</span><span class="w">
  </span><span class="no">P</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="o">(</span><span class="no">Q</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">R</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">Q</span><span class="o">)</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">R</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="no">R</span><span class="w"> </span><span class="o">[</span><span class="no">HP</span><span class="w"> </span><span class="o">[</span><span class="no">HQ</span><span class="w"> </span><span class="no">HR</span><span class="o">]].</span><span class="w">
  </span><span class="kp">split</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HR</span><span class="pi">.</span><span class="w">
  </span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>Conjunctions are commutative and associative.</p>

<h3 id="disjunction">Disjunction</h3>
<p>Two propositions $A \lor B$ is disjunctive when either A or B is true.</p>

<p>To use disjunctive hypothesis in a proof, we proceed by case analysis, which can be done by the <code class="language-plaintext highlighter-rouge">destruct</code> tactic.<br />
Oppositely, to prove a disjunction, it suffices to show that one of its sides hold, which can be done via the tactics <code class="language-plaintext highlighter-rouge">left</code> and <code class="language-plaintext highlighter-rouge">right</code>.</p>

<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise: (or_commut)*)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">or_commut</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">,</span><span class="w">
  </span><span class="no">P</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">Q</span><span class="w">  </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">P</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="o">[</span><span class="no">HP</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="no">HQ</span><span class="o">].</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">  
</span></code></pre></div></div>

<h3 id="falsehood-and-negation">Falsehood and Negation</h3>
<p>The <em>negation</em> or <em>logic not</em> statement $\lnot P$ says P is not true. Coq defines <em>logic not</em> formally as</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Definition</span><span class="w"> </span><span class="no">not</span><span class="w"> </span><span class="o">(</span><span class="no">p</span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">False</span><span class="pi">.</span><span class="w">

</span><span class="k">Notation</span><span class="w"> </span><span class="s2">"~ x"</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="no">not</span><span class="w"> </span><span class="no">x</span><span class="o">).</span><span class="w">
</span></code></pre></div></div>
<p>where <em>False</em> is not the bool value <code class="language-plaintext highlighter-rouge">false</code>, instead, it is an interesting un-provable proposition. It is similar to the concept of “contradiction” in computer science or math lessons. If we have a False in the hypothesis, we are justified to prove anything, because we believe in this consistent universe, there is no such thing as contradiction (Principle of Explosion). Coq accepts any theorems immediately when reading a <code class="language-plaintext highlighter-rouge">False</code> in the hypothesis.</p>

<blockquote>
  <p>ex falso quodlibet (Latin) - “From falsehood follows whatever you want.”</p>
</blockquote>

<p>The way Coq defines <em>logic not</em> explains how we can use it, that is, by the tactic <code class="language-plaintext highlighter-rouge">intros</code>.</p>

<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (not_implies_our_not) *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">not_implies_our_not</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="p">:</span><span class="kr">Prop</span><span class="o">),</span><span class="w">
  </span><span class="o">~</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">Q</span><span class="p">:</span><span class="kr">Prop</span><span class="o">),</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Q</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">HP</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="no">Premise</span><span class="pi">.</span><span class="w">
  </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">Premise</span><span class="pi">.</span><span class="w">
  </span><span class="kp">destruct</span><span class="w"> </span><span class="no">Premise</span><span class="pi">.</span><span class="w">
  </span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<blockquote class="note">
  <p>The example <code class="language-plaintext highlighter-rouge">not_implies_our_not</code> shows the Principle of Explosion in formal symbolic logics:</p>

  <p>$\lnot P \to (\forall Q,~P\to Q)$. For any statements <em>P</em> and <em>Q</em>, if <em>P</em> and not-_P_ are both true, then it logically follows that <em>Q</em> is true.</p>
</blockquote>

<p>Other interesting examples include the classic contrapositive rule: $(P \rightarrow Q) \rightarrow (\neg Q \rightarrow \neg P)$</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (contrapositive) *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">contrapositive</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">),</span><span class="w">
  </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Q</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="nv">~Q</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nv">~P</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="no">HP</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
  </span><span class="kp">unfold</span><span class="w"> </span><span class="no">not</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">HPG</span><span class="pi">.</span><span class="w">
  </span><span class="kp">unfold</span><span class="w"> </span><span class="no">not</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
  </span><span class="kp">apply</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
  </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w">
  </span><span class="kp">apply</span><span class="w"> </span><span class="no">HPG</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>And the de-Morgan’s law: $\neg (P \land Q) \equiv (\neg P \lor \neg Q)$</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (de_morgan_not_or) *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">de_morgan_not_or</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">),</span><span class="w">
    </span><span class="o">~</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">Q</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nv">~P</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="nv">~Q</span><span class="o">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="pi">.</span><span class="w">
  </span><span class="kp">unfold</span><span class="w"> </span><span class="no">not</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
  </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">unfold</span><span class="w"> </span><span class="no">not</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">or_introl</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">unfold</span><span class="w"> </span><span class="no">not</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">or_intror</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>
<h3 id="truth">Truth</h3>
<p>There is a <code class="language-plaintext highlighter-rouge">True</code> as a counterpart for <code class="language-plaintext highlighter-rouge">False</code>, but it is used relatively rarely, since it is both trivial to prove as a goal, or as a hypothesis.</p>

<h3 id="logical-equivalence">Logical Equivalence</h3>
<p>The <em>logical equivalence</em> is often referred as “if and only if” or simply “iff”. Just like <em>negation</em>, Coq doesn’t provide a special definition for iff, instead iff is defined as</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Definition</span><span class="w"> </span><span class="no">iff</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Q</span><span class="o">)</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="o">(</span><span class="no">Q</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">P</span><span class="o">).</span><span class="w">

</span><span class="k">Notation</span><span class="w"> </span><span class="s2">"P &lt;-&gt; Q"</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="no">iff</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="o">)</span><span class="w">
</span></code></pre></div></div>
<p>To prove a logical equivalence $P \iff Q$ as a goal. we need to show both $P \to Q$ and $Q \to P$. The tactic <code class="language-plaintext highlighter-rouge">split</code> can split an iff statement to two such subgoals.</p>

<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (or_distributes_over_and) *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">or_distributes_over_and</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="no">R</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">,</span><span class="w">
  </span><span class="no">P</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="o">(</span><span class="no">Q</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">R</span><span class="o">)</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">Q</span><span class="o">)</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">R</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="pi">.</span><span class="w">
  </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w"> 
    </span><span class="o">+</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[</span><span class="no">HPQ</span><span class="w"> </span><span class="no">HPR</span><span class="o">].</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">HPQ</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[</span><span class="no">HP</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="no">HQ</span><span class="o">].</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">HPR</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[</span><span class="no">HP'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="no">HR</span><span class="o">].</span><span class="w">
      </span><span class="o">*</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP'</span><span class="pi">.</span><span class="w">
      </span><span class="o">*</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HR</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>
<p>Conversely, to use a logical equivalence hypothesis, it is acceptable to simply use <code class="language-plaintext highlighter-rouge">rewrite</code> or <code class="language-plaintext highlighter-rouge">apply</code>.</p>
<h3 id="existential-quantification">Existential Quantification</h3>
<p>Another common basic logical connection is <em>existential quantification</em>.</p>

<p>$\exists x, P x$ there is some x that let the property $P~x$ holds true. The value <code class="language-plaintext highlighter-rouge">x</code> is called a <em>witness</em>.</p>

<p>A <em>constructive proof</em> is the only allowed style to prove an existential claim in Coq. That means we need to give Coq a specific value and convince Coq this value does hold the property that we want to prove. The <code class="language-plaintext highlighter-rouge">exists</code> tactic is responsible for this purpose. Conversely, the tactic <code class="language-plaintext highlighter-rouge">destruct</code> is used to obtain the witness in a existential hypothesis.</p>

<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (dist_exists_or) *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">dist_exists_or</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">X</span><span class="p">:</span><span class="kr">Type</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kr">Prop</span><span class="o">),</span><span class="w">
  </span><span class="o">(</span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="no">x</span><span class="o">)</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="o">(</span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">x</span><span class="o">)</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="o">(</span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">Q</span><span class="w"> </span><span class="no">x</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
   </span><span class="kp">intros</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">Q</span><span class="pi">.</span><span class="w">
   </span><span class="kp">split</span><span class="pi">.</span><span class="w">
   </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[</span><span class="no">xw</span><span class="w"> </span><span class="o">[</span><span class="no">HP</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="no">HQ</span><span class="o">]].</span><span class="w"> 
    </span><span class="o">+</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">xw</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">xw</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
   </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[[</span><span class="no">xwp</span><span class="w"> </span><span class="no">HP</span><span class="o">]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">[</span><span class="no">xwq</span><span class="w"> </span><span class="no">HQ</span><span class="o">]].</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">xwp</span><span class="pi">.</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HP</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">xwq</span><span class="pi">.</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">HQ</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<h2 id="programming-with-propositions">Programming with Propositions</h2>
<h3 id="parameterized-proposition">Parameterized Proposition</h3>
<p>As we mentioned that propositions are just a type just like <code class="language-plaintext highlighter-rouge">nat</code>. As we can do programming with <code class="language-plaintext highlighter-rouge">nat</code>, we can also do programming with <code class="language-plaintext highlighter-rouge">Prop</code>. An especially useful example is <code class="language-plaintext highlighter-rouge">In</code></p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Fixpoint</span><span class="w"> </span><span class="no">In</span><span class="w"> </span><span class="o">{</span><span class="no">A</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Type</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="no">x</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">A</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">l</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">A</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w">
  </span><span class="kr">match</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="kp">with</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">False</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="no">x'</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="no">l'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">x'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">In</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">l'</span><span class="w">
  </span><span class="kr">end</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>The function <code class="language-plaintext highlighter-rouge">In: A -&gt; list A -&gt; Prop</code> checks whether a specific element is in a list.</p>

<p>The example <code class="language-plaintext highlighter-rouge">In_app_iff</code> verify one property of <code class="language-plaintext highlighter-rouge">In</code>: “if an element is in a list, in which the list can be partitioned to 2 parts, the element must be either in the first part or the second part”.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (In_app_iff) *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">In_app_iff</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="no">l'</span><span class="w"> </span><span class="o">(</span><span class="no">a</span><span class="p">:</span><span class="no">A</span><span class="o">),</span><span class="w">
  </span><span class="no">In</span><span class="w"> </span><span class="no">a</span><span class="w"> </span><span class="o">(</span><span class="no">l</span><span class="o">++</span><span class="no">l'</span><span class="o">)</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="no">In</span><span class="w"> </span><span class="no">a</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">In</span><span class="w"> </span><span class="no">a</span><span class="w"> </span><span class="no">l'</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="o">{</span><span class="w">
    </span><span class="kp">induction</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[</span><span class="no">H1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="no">H2</span><span class="o">].</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">IHl</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">or_assoc</span><span class="pi">.</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w">
  </span><span class="o">}</span><span class="w">
  </span><span class="o">{</span><span class="w">
    </span><span class="kp">induction</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[|</span><span class="no">H</span><span class="o">].</span><span class="w"> </span><span class="no">contradiction</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">or_assoc</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">IHl</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">  
  </span><span class="o">}</span><span class="w">
  </span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>The theorem <code class="language-plaintext highlighter-rouge">In_map_iff</code> states and verified another property of <code class="language-plaintext highlighter-rouge">In</code></p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (In_map_iff) *)</span><span class="w">
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">In_map_iff</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">A</span><span class="w"> </span><span class="no">B</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Type</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">B</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">l</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">A</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">y</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">B</span><span class="o">),</span><span class="w">
         </span><span class="no">In</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="o">(</span><span class="no">map</span><span class="w"> </span><span class="no">f</span><span class="w"> </span><span class="no">l</span><span class="o">)</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w">
         </span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">f</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">In</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="no">B</span><span class="w"> </span><span class="no">f</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="no">y</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="c">(* direction -&gt; *)</span><span class="w">
  </span><span class="o">{</span><span class="w">
    </span><span class="kp">induction</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[].</span><span class="w"> </span><span class="c">(* nonsensical premise `In y [ ]` *)</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[</span><span class="no">H1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="no">H2</span><span class="o">].</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">IHl</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">H2</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[</span><span class="no">x'</span><span class="w"> </span><span class="no">H</span><span class="o">].</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">x'</span><span class="pi">.</span><span class="w"> 
        </span><span class="kp">split</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
  </span><span class="o">}</span><span class="w">
  </span><span class="c">(* direction &lt;- *)</span><span class="w">
  </span><span class="o">{</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[</span><span class="no">x</span><span class="w"> </span><span class="o">[</span><span class="no">H1</span><span class="w">  </span><span class="no">H2</span><span class="o">]].</span><span class="w">  </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">In_map</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w"> </span><span class="o">}</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>Similarly, we can defined a function <code class="language-plaintext highlighter-rouge">All</code>, which tests all members of a list posses a property, and then prove it.</p>

<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (All) *)</span><span class="w">
</span><span class="k">Fixpoint</span><span class="w"> </span><span class="no">All</span><span class="w"> </span><span class="o">{</span><span class="no">T</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Type</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kr">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">l</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">T</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w">
  </span><span class="kr">match</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="kp">with</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">True</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="no">x'</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="no">l'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">x'</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">All</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">l'</span><span class="w">
  </span><span class="kr">end</span><span class="pi">.</span><span class="w">

</span><span class="k">Theorem</span><span class="w"> </span><span class="no">All_In</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="kr">forall</span><span class="w"> </span><span class="no">T</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">T</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kr">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">l</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">T</span><span class="o">),</span><span class="w">
    </span><span class="o">(</span><span class="kr">forall</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">In</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">x</span><span class="o">)</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w">
    </span><span class="no">All</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">T</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w">
  </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="o">{</span><span class="w">
    </span><span class="kp">intros</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">induction</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[|</span><span class="w"> </span><span class="no">h</span><span class="w"> </span><span class="no">t</span><span class="o">].</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">simpl</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="no">left</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">IHt</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="no">right</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H0</span><span class="pi">.</span><span class="w"> 
  </span><span class="o">}</span><span class="w">
  </span><span class="o">{</span><span class="w">
    </span><span class="kp">intros</span><span class="w"> </span><span class="no">H1</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w"> </span><span class="kp">induction</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[|</span><span class="w"> </span><span class="no">h</span><span class="w"> </span><span class="no">t</span><span class="o">].</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w"> </span><span class="no">contradiction</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> </span><span class="kp">simpl</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">H2</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">IHt</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H0</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w">
  </span><span class="o">}</span><span class="w">
  </span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<h3 id="applying-propositions">Applying Propositions</h3>
<p>Coq treats proofs as first-class objects, which means the tactic <code class="language-plaintext highlighter-rouge">apply</code> can be used to apply a theorem as it it were a function i.e. applying it to values and hypotheses with matching types.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Check</span><span class="w"> </span><span class="no">add_comm</span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">n</span><span class="w"> </span><span class="no">m</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">nat</span><span class="o">,</span><span class="w"> </span><span class="no">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="no">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="no">n</span><span class="pi">.</span><span class="w">

</span><span class="k">Lemma</span><span class="w"> </span><span class="no">add_comm3_take3</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="kr">forall</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">z</span><span class="o">,</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">(</span><span class="no">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="no">z</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="no">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="no">y</span><span class="o">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="no">x</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">z</span><span class="pi">.</span><span class="w">
  </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">add_comm</span><span class="pi">.</span><span class="w">
  </span><span class="c">(* specialize add_comm with [n m] is assigned as [y z] *)</span><span class="w">
  </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">(</span><span class="no">add_comm</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">z</span><span class="o">).</span><span class="w"> 
  </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>
<p>A more explicit (perhaps redundant, as there is no ambiguity and readability issue) grammar is the <em>with clause</em>:</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kp">rewrite</span><span class="w"> </span><span class="no">add_comm</span><span class="w"> </span><span class="kp">with</span><span class="w"> </span><span class="o">(</span><span class="no">n</span><span class="p">:</span><span class="o">=</span><span class="no">y</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">m</span><span class="p">:</span><span class="o">=</span><span class="no">z</span><span class="o">).</span><span class="w">
</span></code></pre></div></div>

<h2 id="booleans-vs-propositions">Booleans vs Propositions</h2>
<p>The foremost difference between booleans as propositions is <em>decidability</em>. 
<strong>Booleans are decidable</strong>, in the sense of we can have a terminating procedure deciding whether a Boolean expression is true or not. 
<strong>Propositions are undecidable</strong>. We can have a function <code class="language-plaintext highlighter-rouge">nat -&gt; Prop</code> representing the properties like “the nth Turing machine halts”.</p>

<blockquote class="note">
  <p>The Halting Problem is an example of undecidable problems. It ask whether a Turing Machine (computer program) will eventually halt at a given input. The undecidability is given by Alan Turing with a contradiction proof. For more information, please visit: <a href="https://en.wikipedia.org/wiki/Halting_problem">Halting Problem</a></p>
</blockquote>

<p>As a result, booleans can be used with <code class="language-plaintext highlighter-rouge">match</code> but a proposition can’t, as booleans are always computable. However, you can’t have a program in this style:</p>
<pre><code class="language-plain">on input n and w.
if the nth Turing Machine halts on input w:
	print "It halts"
</code></pre>

<p>Another difference is that propositions work with <code class="language-plaintext highlighter-rouge">rewrite</code> and <code class="language-plaintext highlighter-rouge">apply</code> while booleans can’t.</p>

<p>Since Boolean expressions are a subset of Propositions, there are some propositions that are decidable. In most case, these decidable subset of propositions have equivalent Boolean expressions.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Example</span><span class="w"> </span><span class="no">even_42_bool</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">even</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w"> </span><span class="k">Qed</span><span class="pi">.</span><span class="w">

</span><span class="c">(* Even: fun x : nat =&gt; exists n : nat, x = double n *)</span><span class="w">
</span><span class="k">Example</span><span class="w"> </span><span class="no">even_42_prop</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">Even</span><span class="w"> </span><span class="mi">42</span><span class="o">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w"> </span><span class="kp">unfold</span><span class="w"> </span><span class="no">Even</span><span class="pi">.</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="mi">21</span><span class="o">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w"> </span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>
<p>We say that the boolean computation <code class="language-plaintext highlighter-rouge">even 42</code> is <em>reflected</em> in the truth of the proposition <code class="language-plaintext highlighter-rouge">Even 42</code>. If we have a reflective boolean computation, it must holds that the proposition is decidable. It is commonly observed that prove a boolean equation is far more easy than prove a proposition, thanks to the decidability.</p>

<p>A notable nuance is the difference between <code class="language-plaintext highlighter-rouge">=?</code> and <code class="language-plaintext highlighter-rouge">=</code>, where the former is a boolean computation, while the later tells a proposition.</p>

<p>The example <code class="language-plaintext highlighter-rouge">even_double_conv</code> verifies the reflection relation.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (even_double_conv) *)</span><span class="w">
</span><span class="k">Lemma</span><span class="w"> </span><span class="no">even_double_conv</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">n</span><span class="o">,</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">k</span><span class="o">,</span><span class="w">
  </span><span class="no">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="no">even</span><span class="w"> </span><span class="no">n</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="no">double</span><span class="w"> </span><span class="no">k</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="no">S</span><span class="w"> </span><span class="o">(</span><span class="no">double</span><span class="w"> </span><span class="no">k</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="c">(* Hint: Use the [even_S] lemma from [Induction.v]. *)</span><span class="w">
  </span><span class="kp">intros</span><span class="pi">.</span><span class="w">
  </span><span class="kp">induction</span><span class="w"> </span><span class="no">n</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">IHn</span><span class="pi">.</span><span class="w">
    </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">even_S</span><span class="pi">.</span><span class="w">
    </span><span class="kp">destruct</span><span class="w"> </span><span class="o">(</span><span class="no">even</span><span class="w"> </span><span class="no">n</span><span class="o">).</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="pi">.</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
    </span><span class="o">+</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="o">(</span><span class="no">S</span><span class="w"> </span><span class="no">x</span><span class="o">).</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w"> 

</span><span class="k">Theorem</span><span class="w"> </span><span class="no">even_bool_prop</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">n</span><span class="o">,</span><span class="w">
  </span><span class="no">even</span><span class="w"> </span><span class="no">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="no">Even</span><span class="w"> </span><span class="no">n</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">n</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="o">(</span><span class="no">even_double_conv</span><span class="w"> </span><span class="no">n</span><span class="o">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[</span><span class="no">k</span><span class="w"> </span><span class="no">Hk</span><span class="o">].</span><span class="w">
    </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">Hk</span><span class="pi">.</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">exists</span><span class="w"> </span><span class="no">k</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="o">[</span><span class="no">k</span><span class="w"> </span><span class="no">Hk</span><span class="o">].</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">Hk</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">even_double</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">

</span></code></pre></div></div>

<p>Here’s another example. The function <code class="language-plaintext highlighter-rouge">eqb_list</code> checks if the equality of elements of some properties in two lists. Then we verify the correctness of it.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(*Exercise (eqb_list) *)</span><span class="w">
</span><span class="k">Fixpoint</span><span class="w"> </span><span class="no">eqb_list</span><span class="w"> </span><span class="o">{</span><span class="no">A</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Type</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="no">eqb</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">bool</span><span class="o">)</span><span class="w">
                  </span><span class="o">(</span><span class="no">l1</span><span class="w"> </span><span class="no">l2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">A</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">bool</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w">
  </span><span class="kr">match</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="kp">with</span><span class="w">
    </span><span class="o">|</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kr">match</span><span class="w"> </span><span class="no">l2</span><span class="w"> </span><span class="kp">with</span><span class="w"> 
      </span><span class="o">|</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">true</span><span class="w">
      </span><span class="o">|</span><span class="w"> </span><span class="no">h2</span><span class="p">::</span><span class="no">t2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">false</span><span class="w">
      </span><span class="kr">end</span><span class="w">
    </span><span class="o">|</span><span class="w"> </span><span class="no">h1</span><span class="p">::</span><span class="no">t1</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kr">match</span><span class="w"> </span><span class="no">l2</span><span class="w"> </span><span class="kp">with</span><span class="w">
      </span><span class="o">|</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">false</span><span class="w">
      </span><span class="o">|</span><span class="w"> </span><span class="no">h2</span><span class="p">::</span><span class="no">t2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">(</span><span class="no">eqb</span><span class="w"> </span><span class="no">h1</span><span class="w"> </span><span class="no">h2</span><span class="o">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">(</span><span class="no">eqb_list</span><span class="w"> </span><span class="no">eqb</span><span class="w"> </span><span class="no">t1</span><span class="w"> </span><span class="no">t2</span><span class="o">)</span><span class="w">
      </span><span class="kr">end</span><span class="w">
  </span><span class="kr">end</span><span class="pi">.</span><span class="w">

</span><span class="k">Theorem</span><span class="w"> </span><span class="no">eqb_list_true_iff</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="kr">forall</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="o">(</span><span class="no">eqb</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">bool</span><span class="o">),</span><span class="w">
    </span><span class="o">(</span><span class="kr">forall</span><span class="w"> </span><span class="no">a1</span><span class="w"> </span><span class="no">a2</span><span class="o">,</span><span class="w"> </span><span class="no">eqb</span><span class="w"> </span><span class="no">a1</span><span class="w"> </span><span class="no">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="no">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">a2</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="kr">forall</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="no">l2</span><span class="o">,</span><span class="w"> </span><span class="no">eqb_list</span><span class="w"> </span><span class="no">eqb</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="no">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">l2</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="c">(* note that l2 stays in generalized  *)</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">A</span><span class="w"> </span><span class="no">eqb</span><span class="w"> </span><span class="no">H</span><span class="w"> </span><span class="no">l1</span><span class="pi">.</span><span class="w">
  </span><span class="kp">induction</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[|</span><span class="w"> </span><span class="no">h1</span><span class="w"> </span><span class="no">t1</span><span class="w"> </span><span class="no">IH</span><span class="o">].</span><span class="w">
  </span><span class="o">{</span><span class="w">
    </span><span class="kp">split</span><span class="pi">.</span><span class="w">
    </span><span class="kp">destruct</span><span class="w"> </span><span class="no">l2</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">HC</span><span class="pi">.</span><span class="w"> </span><span class="no">discriminate</span><span class="w"> </span><span class="no">HC</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">H'</span><span class="pi">.</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="no">H'</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">   
  </span><span class="o">}</span><span class="w">
  </span><span class="o">{</span><span class="w">
    </span><span class="kp">split</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">l2</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="no">discriminate</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">H'</span><span class="pi">.</span><span class="w"> 
        </span><span class="c">(* Be brave to use the definition of function! 
          This is the very step that examines the function is well-defined. *)</span><span class="w">
        </span><span class="kp">unfold</span><span class="w"> </span><span class="no">eqb_list</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H'</span><span class="pi">.</span><span class="w"> 
        </span><span class="kp">apply</span><span class="w"> </span><span class="no">andb_true_iff</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H'</span><span class="pi">.</span><span class="w">
        </span><span class="kp">destruct</span><span class="w"> </span><span class="no">H'</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[</span><span class="no">H0</span><span class="w"> </span><span class="no">H1</span><span class="o">].</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">IH</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H0</span><span class="pi">.</span><span class="w">
        </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">H0</span><span class="o">,</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
    </span><span class="o">-</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">H'</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">l2</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="no">discriminate</span><span class="pi">.</span><span class="w">
      </span><span class="o">+</span><span class="w"> </span><span class="kp">injection</span><span class="w"> </span><span class="no">H'</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="no">H0</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w">
        </span><span class="kp">simpl</span><span class="pi">.</span><span class="w">
        </span><span class="kp">apply</span><span class="w"> </span><span class="no">andb_true_iff</span><span class="pi">.</span><span class="w"> </span><span class="kp">split</span><span class="pi">.</span><span class="w">
        </span><span class="o">*</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H</span><span class="o">,</span><span class="w"> </span><span class="no">H0</span><span class="pi">.</span><span class="w">
        </span><span class="o">*</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">IH</span><span class="o">,</span><span class="w"> </span><span class="no">H1</span><span class="pi">.</span><span class="w"> 
  </span><span class="o">}</span><span class="w">
  </span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<h2 id="the-logic-of-coq">The Logic of Coq</h2>
<p>The logical core of Coq is called the <em>Calculus of Inductive Constructions</em>. As far as I’m concerned, it is a more rigorous system than paper-and-pencil mathematics, as the absence of two common principles: the <strong>functional extensionality</strong> and the <strong>exclude middle</strong>.</p>
<h3 id="functional-extensionality">Functional Extensionality</h3>
<p>The principle for functional extensionality says that
$\forall x, (f~x = g~x) \to f=g$  - two functions are equal if they produce the same output on every possible input.</p>

<p>Since functional extensionality is not in the logical core of Coq, some obvious propositions are not provable (decidable).</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Example</span><span class="w"> </span><span class="no">function_equality_ex2</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="o">(</span><span class="kr">fun</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="kr">fun</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="no">x</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
   </span><span class="c">(* Stuck *)</span><span class="w">
</span><span class="no">Abort</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>However, we can add this principle if we like and prove the once-stuck theorem.</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Axiom</span><span class="w"> </span><span class="no">functional_extensionality</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="o">{</span><span class="no">X</span><span class="w"> </span><span class="no">Y</span><span class="p">:</span><span class="w"> </span><span class="kr">Type</span><span class="o">}</span><span class="w">
                                    </span><span class="o">{</span><span class="no">f</span><span class="w"> </span><span class="no">g</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">Y</span><span class="o">},</span><span class="w">
  </span><span class="o">(</span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">x</span><span class="p">:</span><span class="no">X</span><span class="o">),</span><span class="w"> </span><span class="no">f</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">g</span><span class="w"> </span><span class="no">x</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">g</span><span class="pi">.</span><span class="w">
  
</span><span class="k">Example</span><span class="w"> </span><span class="no">function_equality_ex2</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="o">(</span><span class="kr">fun</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="kr">fun</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="no">x</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">apply</span><span class="w"> </span><span class="no">functional_extensionality</span><span class="pi">.</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">x</span><span class="pi">.</span><span class="w">
  </span><span class="kp">apply</span><span class="w"> </span><span class="no">add_comm</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>

<p>Defining something as an <code class="language-plaintext highlighter-rouge">Axiom</code> is to make Coq accept it without proof. It can be dangerous if the axiom is <em>inconsistent</em>. An inconsistent axiom ruins the whole logic system. But fortunately, mathematicians already prove that functional extensionality if consistent.</p>

<blockquote class="note">
  <p>An axiom $\Phi$ is inconsistent informally means there is some proposition P that both $P$ and $\lnot P$ is provable by $\Phi$ (a contradiction)</p>
</blockquote>

<p>Another example of using functional extensionality: the function <code class="language-plaintext highlighter-rouge">rev_append</code> reverse a list, but in a tail-recursive manner. We verify it equal to the old one (<code class="language-plaintext highlighter-rouge">rev</code>).</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (tr_rev_correct) *)</span><span class="w">
</span><span class="k">Fixpoint</span><span class="w"> </span><span class="no">rev_append</span><span class="w"> </span><span class="o">{</span><span class="no">X</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="no">l1</span><span class="w"> </span><span class="no">l2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">X</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w">
  </span><span class="kr">match</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="kp">with</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">l2</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="no">l1'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="no">rev_append</span><span class="w"> </span><span class="no">l1'</span><span class="w"> </span><span class="o">(</span><span class="no">x</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="no">l2</span><span class="o">)</span><span class="w">
  </span><span class="kr">end</span><span class="pi">.</span><span class="w">

</span><span class="k">Definition</span><span class="w"> </span><span class="no">tr_rev</span><span class="w"> </span><span class="o">{</span><span class="no">X</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="no">l</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">X</span><span class="o">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w">
  </span><span class="no">rev_append</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="o">[].</span><span class="w">

</span><span class="k">Lemma</span><span class="w"> </span><span class="no">tr_rev_connection</span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="o">(</span><span class="no">l1</span><span class="w"> </span><span class="no">l2</span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">X</span><span class="o">),</span><span class="w">
  </span><span class="no">rev_append</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="no">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">rev_append</span><span class="w"> </span><span class="no">l1</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="no">l2</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="no">l1</span><span class="pi">.</span><span class="w">
  </span><span class="kp">induction</span><span class="w"> </span><span class="no">l1</span><span class="pi">.</span><span class="w">
  </span><span class="o">+</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
  </span><span class="o">+</span><span class="w"> </span><span class="kp">intros</span><span class="w"> </span><span class="no">l2</span><span class="pi">.</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">(</span><span class="no">IHl1</span><span class="w"> </span><span class="o">(</span><span class="no">x</span><span class="p">::</span><span class="no">l2</span><span class="o">)).</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">(</span><span class="no">IHl1</span><span class="w"> </span><span class="o">[</span><span class="no">x</span><span class="o">]).</span><span class="w">
    </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="no">app_assoc</span><span class="pi">.</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">

</span><span class="k">Lemma</span><span class="w"> </span><span class="no">tr_rev_immediate</span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="o">(</span><span class="no">l</span><span class="p">:</span><span class="w"> </span><span class="no">list</span><span class="w"> </span><span class="no">X</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">x</span><span class="p">:</span><span class="w"> </span><span class="no">X</span><span class="o">)</span><span class="w"> </span><span class="o">,</span><span class="w">
  </span><span class="no">rev_append</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="o">[</span><span class="no">x</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">rev_append</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="o">[</span><span class="no">x</span><span class="o">].</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">induction</span><span class="w"> </span><span class="no">l</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="o">[|</span><span class="w"> </span><span class="no">a</span><span class="w"> </span><span class="no">l1</span><span class="o">].</span><span class="w">
  </span><span class="o">+</span><span class="w"> </span><span class="kp">simpl</span><span class="p">;</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
  </span><span class="o">+</span><span class="w"> </span><span class="kp">intros</span><span class="pi">.</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="no">IHl1</span><span class="pi">.</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="no">app_assoc</span><span class="pi">.</span><span class="w">
    </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">(</span><span class="no">tr_rev_connection</span><span class="o">).</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
  
</span><span class="k">Theorem</span><span class="w"> </span><span class="no">tr_rev_correct</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">X</span><span class="o">,</span><span class="w"> </span><span class="o">@</span><span class="no">tr_rev</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="no">rev</span><span class="w"> </span><span class="no">X</span><span class="pi">.</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">X</span><span class="pi">.</span><span class="w">
  </span><span class="kp">apply</span><span class="w"> </span><span class="no">functional_extensionality</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w"> </span><span class="kp">induction</span><span class="w"> </span><span class="no">l</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="ne">reflexivity</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">simpl</span><span class="pi">.</span><span class="w">
    </span><span class="kp">rewrite</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="no">IHl</span><span class="pi">.</span><span class="w">
    </span><span class="kp">unfold</span><span class="w"> </span><span class="no">tr_rev</span><span class="pi">.</span><span class="w">
    </span><span class="kp">simpl</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">tr_rev_immediate</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w">
</span></code></pre></div></div>
<h3 id="exclude-middle">Exclude Middle</h3>
<p>The principal of Exclude Middle is 
$\forall P, P \lor \lnot P$  - for any proposition P, either P is true or not-P is true.</p>

<p>The foremost reason why Coq does not include it maybe because, apparently, it only works with decidable propositions. Another fact that Coq does not like it is that with Exclude Middle, we are able to prove something without actually construct it (for example, see the <a href="https://en.wikipedia.org/wiki/Law_of_excluded_middle#Non-constructive_proofs_over_the_infinite">Non-constructive proofs over the infinite</a>).</p>

<p>But we can always add it if we want:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Definition excluded_middle := forall P : Prop,
  P \/ ~ P.
</code></pre></div></div>

<p>This example demonstrate a safer way to use an unprovable axiom, that is, to put it in the hypothesis:</p>
<div class="language-coq highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(** Exercise (not_exists_dist) *)</span><span class="w">

</span><span class="k">Theorem</span><span class="w"> </span><span class="no">not_exists_dist</span><span class="w"> </span><span class="p">:</span><span class="w">
  </span><span class="no">excluded_middle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="kr">forall</span><span class="w"> </span><span class="o">(</span><span class="no">X</span><span class="p">:</span><span class="kr">Type</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kr">Prop</span><span class="o">),</span><span class="w">
    </span><span class="o">~</span><span class="w"> </span><span class="o">(</span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">x</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="kr">forall</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">x</span><span class="o">).</span><span class="w">
</span><span class="k">Proof</span><span class="pi">.</span><span class="w">
  </span><span class="kp">intros</span><span class="w"> </span><span class="no">em</span><span class="w"> </span><span class="no">X</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="no">H</span><span class="w"> </span><span class="no">x</span><span class="pi">.</span><span class="w">
  </span><span class="k">Check</span><span class="w"> </span><span class="no">excluded_middle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">forall</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kr">Prop</span><span class="o">,</span><span class="w"> </span><span class="no">P</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="no">P</span><span class="pi">.</span><span class="w">
  </span><span class="kp">destruct</span><span class="w"> </span><span class="o">(</span><span class="no">em</span><span class="w"> </span><span class="o">(</span><span class="no">P</span><span class="w"> </span><span class="no">x</span><span class="o">)).</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H0</span><span class="pi">.</span><span class="w">
  </span><span class="o">-</span><span class="w"> </span><span class="kp">unfold</span><span class="w"> </span><span class="no">not</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w"> </span><span class="kp">destruct</span><span class="w"> </span><span class="no">H</span><span class="pi">.</span><span class="w">
    </span><span class="kp">exists</span><span class="w"> </span><span class="no">x</span><span class="pi">.</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="no">H0</span><span class="pi">.</span><span class="w">
</span><span class="k">Qed</span><span class="pi">.</span><span class="w"> 
</span></code></pre></div></div>

<h2 id="summary">Summary</h2>
<p>This post shows the propositional logic calculus in Coq, how to program with it, and the logic core of Coq. Hope you like it.</p>

  </div><a class="u-url" href="/software-foundations/2023/12/03/logics-Coq.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    
    <div class="footer-col-wrapper">
      <div class="footer-col">
        <h2 class="footer-heading">Chew&#39;s Everyday Blog</h2>By wisdom a house is built, and through understanding it is established.</div>
      <div class="footer-col">
        <ul class="contact-list">
          <li class="p-name">Author: Chew Y. Feng</li><li>
              <span>
                Mail: 
              </span>
            <a class="u-email" href="mailto:chew.y.feng@outlook.com">chew.y.feng@outlook.com</a></li><div>
              Find me:<ul class="social-media-list"><li><a href="https://github.com/excitedspider"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">excitedspider</span></a></li></ul>
</div>
            <div class="footer-col-rss">
              <p class="rss-subscribe">subscribe <a href="/feed.xml">via RSS</a></p>
            </div>
        </ul>
      </div>

    </div>

  </div>

</footer>
</body>

</html>
